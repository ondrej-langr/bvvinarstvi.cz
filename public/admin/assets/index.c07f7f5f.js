import{r as u,e as z,Q as q,aE as V,a3 as W,c as k,m as B,am as F,af as N,a as M,p as v,aF as Q,j as d,B as G,h as y,C as Y,ab as H,n as J}from"./index.339d4384.js";import{T as h}from"./TableView.976e255d.js";var K=Object.defineProperty,U=Object.defineProperties,X=Object.getOwnPropertyDescriptors,C=Object.getOwnPropertySymbols,Z=Object.prototype.hasOwnProperty,$=Object.prototype.propertyIsEnumerable,D=(c,n,a)=>n in c?K(c,n,{enumerable:!0,configurable:!0,writable:!0,value:a}):c[n]=a,ee=(c,n)=>{for(var a in n||(n={}))Z.call(n,a)&&D(c,a,n[a]);if(C)for(var a of C(n))$.call(n,a)&&D(c,a,n[a]);return c},te=(c,n)=>U(c,X(n));function se(c=[]){const[n,a]=u.exports.useState(c);return[n,{setState:a,append:(...t)=>a(s=>[...s,...t]),prepend:(...t)=>a(s=>[...t,...s]),insert:(t,...s)=>a(i=>[...i.slice(0,t),...s,...i.slice(t)]),pop:()=>a(t=>{const s=[...t];return s.pop(),s}),shift:()=>a(t=>{const s=[...t];return s.shift(),s}),apply:t=>a(s=>s.map((i,r)=>t(i,r))),applyWhere:(t,s)=>a(i=>i.map((r,p)=>t(r,p)?s(r,p):r)),remove:(...t)=>a(s=>s.filter((i,r)=>!t.includes(r))),reorder:({from:t,to:s})=>a(i=>{const r=[...i],p=i[t];return r.splice(t,1),r.splice(s,0,p),r}),setItem:(t,s)=>a(i=>{const r=[...i];return r[t]=s,r}),setItemProp:(t,s,i)=>a(r=>{const p=[...r];return p[t]=te(ee({},p[t]),{[s]:i}),p}),filter:t=>{a(s=>s.filter(t))}}]}const ne=({})=>{const c=z(),{modelId:n}=q(),[a,_]=u.exports.useState(1),[P,w]=u.exports.useState(20),e=V(),m=W(),[E,x]=u.exports.useState(!1),{data:o,isLoading:S,isError:I,refetch:T}=k(e==null?void 0:e.name,{params:{page:a,limit:P,...e!=null&&e.hasTimestamps?{"orderBy.created_at":"desc"}:{}}}),{t:g}=B(),[t,s]=se(o==null?void 0:o.data);u.exports.useEffect(()=>{o!=null&&o.data&&s.setState(o==null?void 0:o.data)},[o]);const i=u.exports.useMemo(()=>{if(!o)return!1;const{data:l,...f}=o;return f},[o]),r=async({source:l,destination:f})=>{if((f==null?void 0:f.index)===void 0)return;x(!0);const b=t[l.index].id,O=t[f.index].id;b!==O&&(s.reorder({from:l.index,to:f.index}),await M.entries.swap(e.name,{fromId:b,toId:O})),x(!1)},p=u.exports.useMemo(()=>{if(!!e)return F(e)},[e]),j=e&&(m==null?void 0:m.can({action:"delete",targetModel:e==null?void 0:e.name}))?async l=>{confirm(g(N.ON_DELETE_REQUEST_PROMPT))&&(await M.entries.delete(e.name,l),T())}:void 0,A=e&&(m==null?void 0:m.can({action:"create",targetModel:e==null?void 0:e.name}))?async l=>{confirm(g(N.ENTRY_ITEM_DUPLICATE))&&c(v.entryTypes(e==null?void 0:e.name).duplicate(l))}:void 0,R=()=>c(v.entryTypes(e==null?void 0:e.name).create),L=l=>c(v.entryTypes(e==null?void 0:e.name).view(l));return u.exports.useEffect(()=>_(1),[n]),!e||!p||Q(e.name)?d(G,{text:g("This model with this id does not exist.")}):y(Y,{children:[y("div",{className:"flex w-full flex-col justify-between gap-5 py-10 md:flex-row",children:[d("h1",{className:"text-3xl font-semibold capitalize",children:g(e.name)}),d("div",{className:"flex items-center gap-5",children:(m==null?void 0:m.can({action:"create",targetModel:e.name}))&&y(H,{color:"green",className:" items-center font-semibold uppercase",size:"md",onClick:R,children:[d("span",{className:"hidden md:block",children:g("Add new entry")}),d(J,{className:"inline-block h-5 w-5 md:ml-3"})," "]})})]}),d(h,{isLoading:S||I,items:t,columns:p,onEditAction:L,onDeleteAction:j,onDuplicateAction:A,ordering:!!e.hasOrdering,onDragEnd:r,disabled:E}),y(h.Footer,{children:[d(h.PageSizeSelect,{value:String(P),onChange:l=>{w(l?Number(l):20)}}),i&&d(h.Metadata,{className:"mr-auto ml-5",...i}),d(h.Pagination,{className:"ml-auto",total:(o==null?void 0:o.last_page)||1,page:a,onChange:_})]})]})};export{ne as default};
